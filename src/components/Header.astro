---
import Link from './Link.astro';
import { Image } from 'astro:assets';
import logoLightText from '@/images/logo-light-text.svg';
console.log(Link)
---

<header class="layout-header" data-scroll="false">
	<div class="layout-header--content">
		<Link class="header-logo" title="">
			<Image src={ logoLightText } alt="" loading="eager" />
		</Link>
		<nav class="primary-nav">
			<button class="primary-nav--button" aria-controls="primary-nav" aria-expanded="false">
				<div class="primary-nav--button-text">Men√∫</div>
				<div class="primary-nav--button-icon" aria-hidden="true"></div>
			</button>

			<ul class="primary-nav--list" id="primary-nav" data-status="closed">
				<li><Link title="" class="primary-nav--item" isCurrent><span>Inicio</span></Link></li>
				<li><Link path="projects" title="" class="primary-nav--item" isCurrent><span>Mis proyectos</span></Link></li>
				<li><Link path="contact" title="" class="primary-nav--item nav-call-to-action" isCurrent><span>Contacto</span></Link></li>
			</ul>
		</nav>
	</div>
	<div class="layout-header--border"></div>
</header>

<style lang="scss">
	.layout-header {
		position: sticky;
		top: 0;
		left: 0;
		z-index: 100000;

		grid-area: header;
		display: grid;

		padding: var(--header-space-block) var(--spacer-200);

		background-color: var(--color-secondary-300);
		background: linear-gradient(var(--color-secondary-500), var(--color-secondary-200));

		@include breakpoint(medium, down) {
			position: relative;
		}
	}

	.layout-header--content {
		justify-self: center;
		display: grid;
		grid-template-columns: auto auto;
		grid-template-rows: var(--header-height);
		column-gap: var(--spacer-400);

		width: min(var(--content-width), 100%);
	}

	.layout-header--border {
		position: absolute;
		top: 100%;
		left: 0;
		z-index: 2;

		width: 100%;
		height: 3px;

		background-color: var(--color-primary-800);
		box-shadow: var(--box-shadow);
	}

	.header-logo {
		height: 100%;
		
		img {
			display: block;

			width: auto;
			height: 100%;
		}
	}

	.primary-nav {
		align-self: center;
	}

	@include breakpoint(xxmedium, up) {
		.primary-nav--button {
			display: none;
		}

		.primary-nav--list {
			display: flex;
			justify-content: flex-end;
			align-items: center;
			column-gap: calc(var(--spacer-100) * 1.5);
		}

		.primary-nav--item {
			display: block;
			overflow-x: hidden;

			padding: var(--spacer-100) 0;

			line-height: 1;
			color: var(--color-font-secondary);
			font-size: .95rem;
			font-weight: var(--font-weight-bold);
			white-space: nowrap;
			
			&:not(.nav-call-to-action) {
				span {
					position: relative;

					display: block;
					
					padding: 0 3px;

					line-height: 1;
					color: var(--color-font-secondary);

					&::after {
						content: '';

						position: absolute;
						top: 100%;
						left: 0;

						width: 100%;
						height: 2px;
						margin-top: 3px;

						background-color: currentColor;

						transform: translateX(calc(-100% - 2px));
						transition: transform 125ms ease-in;
					}
				}
			}

			&.nav-call-to-action {
				padding: var(--spacer-100) calc(var(--spacer-100) * 1.5);

				background-color: var(--color-accent-600);
				background: linear-gradient(var(--color-accent-700), var(--color-accent-500));
				border: 1px solid var(--color-accent-700);
				border-radius: 3px;
				box-shadow: inset 0 0 2px 0 hsl(0 0% 0% / .5);

				color: var(--color-font-primary);

				transition: border-color 100ms ease-in;

				span {
					line-height: 1;
				}
			}

			&:hover, &:active, &:focus-visible, &[aria-current="page"] {
				color: var(--color-font-secondary);

				&:not(.nav-call-to-action) {
					span {
						&::after {
							transform: translateX(0);
						}
					}
				}

				&.nav-call-to-action {
					border-color: var(--color-accent-300);

					color: var(--color-font-primary);
				}
			}

			&:active {
				&.nav-call-to-action {
					background: linear-gradient(var(--color-accent-500), var(--color-accent-700));
				}
			}
		}
	}

	@keyframes primaryNavButtonOpen {
		0% {
			clip-path: polygon(0 87.5%, 50% 87.5%, 50% 87.5%, 100% 87.5%, 100% 72.5%, 0 72.5%, 0 57.5%, 100% 57.5%, 100% 42.5%, 0 42.5%, 0 27.5%, 100% 27.5%, 100% 12.5%, 50% 12.5%, 50% 12.5%, 0 12.5%);

			rotate: 0deg;
		}

		49.99% {

			clip-path: polygon(12.5% 87.5%, 50% 87.5%, 50% 87.5%, 87.5% 87.5%, 87.5% 72.5%, 87.5% 72.5%, 87.5% 57.5%, 87.5% 57.5%, 87.5% 42.5%, 87.5% 42.5%, 87.5% 27.5%, 87.5% 27.5%, 87.5% 12.5%, 50% 12.5%, 50% 12.5%, 12.5% 12.5%);
		}

		50.01% {
			clip-path: polygon(12.5% 87.5%, 25% 87.5%, 50% 87.5%, 75% 87.5%, 87.5% 87.5%, 87.5% 75%, 87.5% 50%, 87.5% 25%, 87.5% 12.5%, 75% 12.5%, 50% 12.5%, 25% 12.5%, 12.5% 12.5%, 12.5% 25%, 12.5% 50%, 12.5% 75%);
		}

		100% {
			clip-path: polygon(12.5% 87.5%, 25% 87.5%, 50% 62.5%, 75% 87.5%, 87.5% 87.5%, 87.5% 75%, 62.5% 50%, 87.5% 25%, 87.5% 12.5%, 75% 12.5%, 50% 37.5%, 25% 12.5%, 12.5% 12.5%, 12.5% 25%, 37.5% 50%, 12.5% 75%);

			rotate: 180deg;
		}
	}

	@keyframes primaryNavButtonClose {
		100% {
			clip-path: polygon(0 87.5%, 50% 87.5%, 50% 87.5%, 100% 87.5%, 100% 72.5%, 0 72.5%, 0 57.5%, 100% 57.5%, 100% 42.5%, 0 42.5%, 0 27.5%, 100% 27.5%, 100% 12.5%, 50% 12.5%, 50% 12.5%, 0 12.5%);

			rotate: 0deg;
		}

		50.01% {

			clip-path: polygon(12.5% 87.5%, 50% 87.5%, 50% 87.5%, 87.5% 87.5%, 87.5% 72.5%, 87.5% 72.5%, 87.5% 57.5%, 87.5% 57.5%, 87.5% 42.5%, 87.5% 42.5%, 87.5% 27.5%, 87.5% 27.5%, 87.5% 12.5%, 50% 12.5%, 50% 12.5%, 12.5% 12.5%);
		}

		49.99% {
			clip-path: polygon(12.5% 87.5%, 25% 87.5%, 50% 87.5%, 75% 87.5%, 87.5% 87.5%, 87.5% 75%, 87.5% 50%, 87.5% 25%, 87.5% 12.5%, 75% 12.5%, 50% 12.5%, 25% 12.5%, 12.5% 12.5%, 12.5% 25%, 12.5% 50%, 12.5% 75%);
		}

		0% {
			clip-path: polygon(12.5% 87.5%, 25% 87.5%, 50% 62.5%, 75% 87.5%, 87.5% 87.5%, 87.5% 75%, 62.5% 50%, 87.5% 25%, 87.5% 12.5%, 75% 12.5%, 50% 37.5%, 25% 12.5%, 12.5% 12.5%, 12.5% 25%, 37.5% 50%, 12.5% 75%);

			rotate: 180deg;
		}
	}

	@keyframes primaryNavOpen {
		0% {
			clip-path: circle(0% at top right);
		}

		100% {
			clip-path: circle(141% at top right);
		}
	}

	@keyframes primaryNavClose {
		100% {
			clip-path: circle(0% at top right);
		}

		0% {
			clip-path: circle(141% at top right);
		}
	}

	@include breakpoint(xmedium, down) {
		.primary-nav {
			display: grid;
			align-items: center;
			justify-items: end;
		}

		.primary-nav--button {
			display: grid;
			grid-template-columns: auto auto;
			column-gap: var(--spacer-100);
			align-items: center;

			background-color: transparent;
			border: none;

			cursor: pointer;

			&[aria-expanded="true"] .primary-nav--button-icon {
				clip-path: polygon(12.5% 87.5%, 25% 87.5%, 50% 62.5%, 75% 87.5%, 87.5% 87.5%, 87.5% 75%, 62.5% 50%, 87.5% 25%, 87.5% 12.5%, 75% 12.5%, 50% 37.5%, 25% 12.5%, 12.5% 12.5%, 12.5% 25%, 37.5% 50%, 12.5% 75%);

				animation: primaryNavButtonOpen 150ms linear forwards;
			}
		}

		.primary-nav--button-text {
			color: var(--color-font-secondary);
			line-height: 1;
			font-weight: var(--font-weight-bold);
			font-size: .8rem;
		}

		.primary-nav--button-icon {
			width: 24px;
			height: 24px;

			background-color: var(--color-font-secondary);

			clip-path: polygon(0 87.5%, 50% 87.5%, 50% 87.5%, 100% 87.5%, 100% 72.5%, 0 72.5%, 0 57.5%, 100% 57.5%, 100% 42.5%, 0 42.5%, 0 27.5%, 100% 27.5%, 100% 12.5%, 50% 12.5%, 50% 12.5%, 0 12.5%);
			
			animation: primaryNavButtonClose 150ms linear forwards;
		}

		.primary-nav--list {
			position: absolute;
			top: calc(100% + 3px);
			right: 0;

			width: min(300px, 80%);

			background-color: var(--color-tertiary-100);
			border-bottom: 1px solid var(--color-tertiary-400);
			border-left: 1px solid var(--color-tertiary-400);
			border-radius: 0 0 0 10px;
			box-shadow: var(--box-shadow);

			li {
				overflow: hidden;

				&:last-child {
					border-radius: 0 0 0 10px;
				}
			}

			&[data-status="opened"] {
				display: block;

				animation: primaryNavOpen 350ms ease-in-out forwards;
			}

			&[data-status="closing"] {
				animation: primaryNavClose 350ms ease-in-out forwards;
			}

			&[data-status="closed"] {
				display: none;
			}
		}

		.primary-nav--item {
			display: grid;
			justify-content: center;
			align-content: center;

			width: 100%;
			height: 50px;
			
			color: var(--color-font-secondary);
			font-weight: var(--font-weight-bold);
			font-size: .9rem;

			transition: background-color 100ms linear;

			&:hover, &:active, &:focus-visible {
				background-color: var(--color-tertiary-200);

				color: var(--color-font-secondary);
			}

			&[aria-current="page"] {
				background-color: var(--color-tertiary-300);
			}
		}
	}
</style>