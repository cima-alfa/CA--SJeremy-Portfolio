---
import Link from '@/components/Link.astro';

let { action } = Astro.props;

let attributes = { ...Astro.props };

delete attributes.element;
delete attributes.path;
delete attributes.action;

attributes.class ??= '';
attributes.class += ' content-form';

const path = action;

action = '{%URL%}';
---

<Link element="form" path={ path } action={ action } { ...attributes }>
	<slot />
</Link>

<style lang="scss" is:global>
	.content-form {
		--__label-padding-bottom: 7px;

		--__input-padding-inline: 8px;
		--__input-padding-block: 5px;
		--__input-border-radius: 3px;
		--__input-box-shadow: 0 0 3px 0 hsl(0 0% 0% / .085);

		--__select-arrow-width: 30px;

		.form-label {
			padding-bottom: var(--__label-padding-bottom);

			font-size: .95rem;
			font-weight: var(--font-weight-bold);
			line-height: 1.1;
		}

		.form-label-inline {
			user-select: none;

			font-size: .95rem;
			font-weight: var(--font-weight-bold);

			margin-right: 1em;
		}

		input:not([type="checkbox"], [type="radio"], [type="submit"]), select, textarea {
			appearance: none;
			width: 100%;
			padding-block: var(--__input-padding-block);
			padding-inline: var(--__input-padding-inline);

			background-color: var(--color-primary-900);
			border: 1px solid var(--color-primary-500);
			border-radius: var(--__input-border-radius);
			box-shadow: var(--__input-box-shadow);

			transition: border-color 100ms linear;

			&:focus {
				outline: none;
				border-color: var(--color-accent-500);
			}
		}

		input:is([type="checkbox"], [type="radio"]) {
			margin: 0 4px 0 0;

			accent-color: var(--color-accent-300);
		}

		.form-select {
			position: relative;	
			
			overflow: hidden;

			border: 1px solid var(--color-primary-500);
			border-radius: var(--__input-border-radius);
			box-shadow: var(--__input-box-shadow);

			&::before {
				content: '';

				position: absolute;
				top: 0;
				left: 0;
				z-index: -2;

				width: 100%;
				height: 100%;

				background-color: var(--color-primary-900);
			}

			&::after {
				content: '';

				position: absolute;
				top: 50%;
				right: calc(var(--__select-arrow-width) / 2);
				z-index: -1;
				transform: translate(50%, -50%);

				width: 0;
				height: 0;
				border-style: solid;
				border-width: 8.7px 5px 0 5px;
				border-color: var(--color-font-primary) transparent transparent transparent;
			}

			&:focus-within {
				border-color: var(--color-accent-500);
			}
		}

		select {
			padding-right: calc(var(--__select-arrow-width) + var(--__input-padding-inline));

			background-color: transparent;
			border: none;
			border-radius: 0;
			box-shadow: none;
		}

		textarea {
			resize: vertical;
			min-height: 150px;
			max-height: 250px;
		}

		.form-submit {
			appearance: none;
			padding: var(--spacer-100) var(--spacer-200);
			min-width: 200px;

			background-color: var(--color-accent-600);
			background: linear-gradient(var(--color-accent-700), var(--color-accent-500));
			border: 1px solid var(--color-accent-700);
			border-radius: var(--__input-border-radius);
			box-shadow: var(--__input-box-shadow), inset 0 0 2px 0 hsl(0 0% 0% / .5);

			font-size: .95rem;
			font-weight: var(--font-weight-bold);
			text-align: center;
			color: var(--color-font-primary);

			transition: border-color 100ms ease-in;

			cursor: pointer;
			user-select: none;

			&:hover, &:active, &:focus-visible {
				border-color: var(--color-accent-300);
			}

			&:active {
				background: linear-gradient(var(--color-accent-500), var(--color-accent-700));
			}
		}
	}

	.content-form--text {
		font-size: .9rem;
	}
</style>